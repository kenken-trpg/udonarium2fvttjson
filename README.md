# ユドナリウムXML to FVTT JSON Converter

## 概要

このスクリプトは、[ユドナリウム](https://udonarium.app/) で作成されたキャラクターシートのXMLファイルを、[Foundry Virtual Tabletop (FVTT)](https://foundryvtt.com/) でインポート可能なJSON形式に変換します。D&D 5e のキャラクターデータをFVTTに移行したい場合に役立ちます。

**⚠️ 注意:** このスクリプトは、ユドナリウムのXML構造に依存しています。ユドナリウムのアップデートによりXML構造が変更された場合、スクリプトが正常に動作しなくなる可能性があります。

## 前提条件

-   **Python 3.6 以上** がインストールされていること。
    -   Pythonのインストール方法がわからない場合は、「Python インストール」などで検索して、お使いのOS（Windows, macOS, Linux）に合わせた方法を調べてください。
-   **lxml ライブラリ** がインストールされていること。
    -   ターミナルまたはコマンドプロンプトで `pip install lxml` を実行してインストールします。
    -   `pip` が見つからない、またはエラーになる場合は、「pip install できない」などで検索して解決策を調べてください。

## 使い方

1.  **D&D5E キャラクターデータベースからキャラクターシートをエクスポート:**
    -    D&D総合コミュニティ　D&D5E キャラクターデータベース　（安定版） https://dndjp.sakura.ne.jp/LIST.php
          - キャラクターシートのIDを確認
    -   D&D5Eプレイヤーキャラクター コマ作成  https://direboar.github.io/githubpage-test/dist/#/udonarium/playercharacter
          - キャラクターシートのURLを貼り付けコマ作成
    -   zipファイルの中にあるdata.xmlを使用します。

2.  **ユドナリウムからキャラクターキャラクターシートをエクスポート:**
    -   ユドナリウムで変換したいキャラクターコマを右クリックします。
    -   「詳細を表示」→保存　でzipファイルをダウンロードします。
    -   zipファイルの中にあるdata.xmlを使用します。

3.  **スクリプトの実行:**
    -   このリポジトリをクローンするか、`udonarium_to_fvtt.py` ファイルをダウンロードします。
        -   GitHubの緑色の「Code」ボタンから「Download ZIP」を選び、ダウンロードしたファイルを展開（解凍）すると、ファイル一式を入手できます。
    -   ターミナルまたはコマンドプロンプトを開き、`udonarium_to_fvtt.py` ファイルがあるディレクトリに移動します。（`cd` コマンドを使用）
        - 例: `cd Downloads/udonarium-to-fvtt-main` (ダウンロードフォルダ内の`udonarium-to-fvtt-main`フォルダに移動する場合)

    -   以下のコマンドを実行します。

        ```bash
        python udonarium_to_fvtt.py <入力XMLファイル名>
        ```

        -   `<入力XMLファイル名>` は、ユドナリウムからダウンロードしたXMLファイルの名前に置き換えてください。
        -   例: `python udonarium_to_fvtt.py character_data.xml`
        -   成功すると、`2converted_<元のファイル名>.json` というファイルが生成されます。

4.  **FVTTへのインポート:**
    -   FVTTのワールドに入って「キャラクター」タブで、キャラクター右クリックしてインポート
    -   インポートファイル```参照```で生成されたJSONファイルを選択してインポートします。

## 変換されるデータ

このスクリプトは、以下のデータをユドナリウムXMLからFVTT JSONに変換します。

-   キャラクター名
-   能力値 (筋力、敏捷力など)
-   ヒットポイント (現在値と最大値)
-   ヒットダイス
-   属性 (アライメント)
-   特徴 (人格的特徴、尊ぶもの、関わり深いもの、弱み)
-   呪文スロット (レベル1～9)
-   変換できなかったデータは、経歴(Biography)にまとめて追加されます。

**注意点:**

-   ユドナリウムの「共有メモ」は変換されません。
-   技能、セーヴィングスローは自動計算に依存するため、直接は変換されません。
-   FVTTのバージョンやモジュールによっては、一部のデータが正しく表示されない場合があります。

## トラブルシューティング

-   **エラーメッセージが表示される:**
    -   `FileNotFoundError`：指定したXMLファイルが存在しない場合に表示されます。ファイル名やパスが正しいか確認してください。
    -   `XMLSyntaxError`：XMLファイルの形式が正しくない場合に表示されます。ユドナリウムから正しくエクスポートされているか確認してください。
    -   その他のエラー：Pythonのバージョンや必要なライブラリがインストールされているか確認してください。エラーメッセージをよく読み、原因を特定してください。
-   **変換後のデータがおかしい:**
    -   FVTT上でデータを確認し、必要に応じて手動で修正してください。
    -   ユドナリウムのXML構造が変更された可能性があります。スクリプトの更新が必要な場合があります。

## 免責事項

このスクリプトの使用によって生じたいかなる損害についても、作者は責任を負いません。自己責任でご利用ください。
